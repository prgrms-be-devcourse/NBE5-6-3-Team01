<!DOCTYPE html>
<html lang="ko" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}"
>
<head>
  <meta charset="UTF-8">
  <title>ëª¨ì„</title>
  <link rel="stylesheet" th:href="@{/css/meeting/meeting.css}"/>
</head>
<body>
<main layout:fragment="content">
  <!-- ëª¨ì„ ë¦¬ìŠ¤íŠ¸ -->
  <div>
    <div class="meeting-header">
      <h4>ë‚˜ì˜ ì°¸ì—¬ ëª¨ì„</h4>
      <div style="display: flex; gap: 10px;">
        <a class="tab" onclick="openPopup(); return false;">ğŸ””</a>
        <a href="/meetings/regist" class="create">ëª¨ì„ ìƒì„±í•˜ê¸°</a>
      </div>

    </div>

    <div class="empty" th:if="${#lists.isEmpty(meetingList)}">
      ì°¸ì—¬ ì¤‘ì¸ ëª¨ì„ì´ ì—†ìŠµë‹ˆë‹¤.<br/>
      ëª¨ì„ì„ ë§Œë“¤ì–´ì„œ ì‹ì‚¬ ë©”ë‰´ë¥¼ ì†ì‰½ê²Œ ì„ ì •í•´ ë³´ì„¸ìš”!
    </div>

    <div class="scroll-container">
      <div th:each="meeting:${meetingList}" class="group-card">
        <div class="group-info">
          <div>
            <div th:text="${meeting.title}" style="font-size: 25px; font-weight: bold"></div>
            <div th:text="${meeting.description}"
                 style="font-weight: bold; margin-bottom: 2vh;"></div>
            <div>ëª¨ì„ ìƒì„±ì: <span th:text="${meeting.user.nickname}"></span></div>
            <div th:switch="${meeting.purpose.name()}">
              ëª¨ì„ ìœ í˜•:
              <span th:case="'LUNCH'">ì ì‹¬</span>
              <span th:case="'DINING_TOGETHER'">íšŒì‹</span>
              <span th:case="'STUDY'">ìŠ¤í„°ë””</span>
            </div>
            <div>ë”ì¹˜í˜ì´ ì—¬ë¶€:
              <span th:if="${meeting.isDutch}" th:text="Y"></span>
              <span th:unless="${meeting.isDutch}" th:text="N"></span>
            </div>
            <div>
              ìƒì„±ì¼ì: <span th:text="${#temporals.format(meeting.createdAt, 'yyyyë…„ MMì›” ddì¼')}"></span>
            </div>
          </div>
        </div>
        <a th:href="@{'/meetings/detail/'+${meeting.id}}" class="move">ì´ë™</a>
      </div>
    </div>
  </div>

  <script>
    function openPopup(url) {
      const popupWidth = 1000;
      const popupHeight = 700;

      const screenLeft = window.screenLeft !== undefined ? window.screenLeft : screen.left;
      const screenTop = window.screenTop !== undefined ? window.screenTop : screen.top;

      const screenWidth = window.innerWidth || document.documentElement.clientWidth || screen.width;
      const screenHeight = window.innerHeight || document.documentElement.clientHeight
          || screen.height;

      const left = screenLeft + (screenWidth - popupWidth) / 2;
      const top = screenTop + (screenHeight - popupHeight) / 2;

      window.open(
          "notification/modal/alarm.html",
          'popupWindow',
          `width=${popupWidth},height=${popupHeight},left=${left},top=${top},resizable=yes,scrollbars=yes`
      );

      // ì´ˆëŒ€ ìˆ˜ë½ í›„, ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
      const popupCheck = setInterval(function () {
        if (popupWindow.closed) {
          clearInterval(popupCheck);
          window.location.href = "/";
        }
      }, 500);
    }
  </script>
</main>
</body>
</html>
